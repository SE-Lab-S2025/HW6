# سیستم مدیریت پویای مصرف انرژی هوشمند در یک ساختمان اداری

این پروژه به عنوان بخشی از آزمایشگاه «الگوهای طراحی شیءگرا و بازآرایی کد» پیاده‌سازی شده است. هدف اصلی، طراحی و ساخت یک سیستم نرم‌افزاری برای مدیریت هوشمند و پویای مصرف انرژی در یک ساختمان اداری است. این سیستم قادر است وضعیت دستگاه‌های مختلف ساختمان (مانند سیستم گرمایشی، تهویه و روشنایی) را بر اساس سیاست‌های مختلف انرژی تغییر داده و هزینه مصرف را محاسبه کند.

برای پیاده‌سازی این سیستم، از دو الگوی طراحی کلیدی **Strategy** و **State** استفاده شده است.

---

## الگوهای طراحی استفاده شده

### ۱. الگوی طراحی Strategy (راهبرد) برای محاسبه هزینه انرژی

**چرا از این الگو استفاده شد؟**

بر اساس نیازمندی‌های پروژه، سیستم باید بتواند هزینه مصرف انرژی را بر اساس سیاست‌های تعرفه‌ای مختلف محاسبه کند. این سیاست‌ها شامل «تعرفه معمولی (Standard)»، «تعرفه زمان اوج مصرف (Peak Hours)» و «تعرفه سبز (Green Mode)» هستند. نکته مهم این است که این سیاست‌ها باید در زمان اجرای برنامه توسط مدیر ساختمان قابل تغییر باشند.

الگوی **Strategy** برای این سناریو ایده‌آل است، زیرا به ما اجازه می‌دهد تا هر یک از الگوریتم‌های محاسبه هزینه را در یک کلاس مجزا کپسوله کنیم. با این روش، کلاس اصلی مدیریت سیستم (Context) از جزئیات پیاده‌سازی هر الگوریتم مستقل باقی می‌ماند و می‌تواند به راحتی و در هر زمانی، الگوریتم محاسبه را تغییر دهد. این الگو اصل «جداسازی بخش‌های متغیر برنامه» را به خوبی پیاده‌سازی می‌کند.

**نحوه پیاده‌سازی:**

1.  **رابط `PricingStrategy`:**
    یک `interface` به نام `PricingStrategy` تعریف شد که دارای یک متد `calculateCost(int units)` است. این رابط، قراردادی را برای تمام کلاس‌های استراتژی تعریف می‌کند.

2.  **کلاس‌های پیاده‌ساز (Concrete Strategies):**
    سه کلاس مجزا این رابط را پیاده‌سازی کردند که هر کدام منطق محاسبه یکی از تعرفه‌ها را در خود دارند:
    * `StandardPricingStrategy`: هزینه هر واحد انرژی را ۵۰۰ تومان محاسبه می‌کند.
    * `PeakHoursPricingStrategy`: هزینه هر واحد انرژی را ۱۰۰۰ تومان محاسبه می‌کند.
    * `GreenModePricingStrategy`: هزینه هر واحد انرژی را ۳۰۰ تومان محاسبه می‌کند.

3.  **کلاس `EnergyManagementSystem` (Context):**
    این کلاس اصلی، یک مرجع (reference) به `PricingStrategy` نگه می‌دارد. هنگامی که متد محاسبه هزینه (`calculateEnergyCost`) در این کلاس فراخوانی می‌شود، این کلاس مسئولیت محاسبه را به شیء استراتژی فعلی خود واگذار (delegate) می‌کند. با استفاده از متد `setPricingStrategy`، مدیر سیستم می‌تواند در هر لحظه استراتژی محاسبه هزینه را تغییر دهد.

### ۲. الگوی طراحی State (حالت) برای مدیریت وضعیت سیستم

**چرا از این الگو استفاده شد؟**

سیستم انرژی ساختمان می‌تواند در یکی از سه حالت مشخص قرار بگیرد: «فعال (Active)»، «اقتصادی (Eco Mode)» یا «خاموش (Shutdown)». رفتار سیستم، مانند دستگاه‌های فعال و پیام‌های وضعیت، بسته به حالت فعلی آن به طور کامل تغییر می‌کند.

الگوی **State** به یک شیء اجازه می‌دهد تا رفتار خود را هنگام تغییر حالت داخلی‌اش تغییر دهد، به طوری که به نظر می‌رسد کلاس شیء تغییر کرده است. این الگو ما را از نوشتن بلوک‌های شرطی بزرگ و تو در توی `if/else` یا `switch` در کلاس اصلی برای مدیریت رفتارهای وابسته به حالت، بی‌نیاز می‌کند. به جای آن، تمام منطق مربوط به یک حالت خاص، در یک کلاس مجزا کپسوله می‌شود.

**نحوه پیاده‌سازی:**

1.  **رابط `SystemState`:**
    یک `interface` به نام `SystemState` تعریف شد که متدی مانند `handleStateChange()` دارد. این متد، رفتارها و عملیات مربوط به هر حالت خاص (مانند چاپ پیام مناسب) را تعریف می‌کند.

2.  **کلاس‌های پیاده‌ساز (Concrete States):**
    سه کلاس مجزا این رابط را پیاده‌سازی کردند که هر کدام نماینده یکی از حالت‌های سیستم هستند:
    * `ActiveState`: نماینده حالتی است که در آن تمام سیستم‌های ساختمان روشن هستند.
    * `EcoState`: نماینده حالتی است که تنها سیستم‌های حیاتی (مانند روشنایی اضطراری و تهویه کم‌مصرف) روشن هستند.
    * `ShutdownState`: نماینده حالتی است که در آن تمام سیستم‌ها خاموش هستند.

3.  **کلاس `EnergyManagementSystem` (Context):**
    این کلاس یک مرجع به حالت فعلی سیستم (`currentState`) را در خود نگه می‌دارد. هر درخواستی که به این کلاس ارسال می‌شود و رفتارش وابسته به حالت است (مانند `getCurrentStatus`)، به شیء حالت فعلی واگذار می‌شود. تغییر حالت سیستم نیز با جایگزین کردن شیء حالت فعلی با یک نمونه از کلاس حالت جدید انجام می‌شود. برای مثال، برای تغییر حالت از `Active` به `Eco`، کافی است شیء `currentState` از یک نمونه `ActiveState` به یک نمونه `EcoState` تغییر یابد.

---

## نحوه اجرای برنامه

پروژه با استفاده از Maven مدیریت می‌شود. برای اجرای برنامه، متد `main` در کلاس `Main.java` را اجرا کنید. برنامه در حالت اولیه `Active` و با تعرفه `Standard` شروع به کار می‌کند. سپس یک منوی تعاملی برای کاربر نمایش داده می‌شود که از طریق آن می‌توان وضعیت‌ها و سیاست‌ها را تغییر داد، هزینه را شبیه‌سازی کرد یا از برنامه خارج شد.